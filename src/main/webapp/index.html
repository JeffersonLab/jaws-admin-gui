<html>
<body>
Hello
<div>
    <form onsubmit="return false;">
        Send: <input id="msg" type="text" name="data" value=""/>
        <input id="submit" type="button" value="Send"/>
    </form>
</div>
<ul></ul>
<p>
</p>
<script>
    let button = document.getElementById('submit');

    button.addEventListener("click", function(e) {
        let msg = document.getElementById("msg");

        let promise = fetch("proxy/rest", {
            method: "PUT",
            body: JSON.stringify({
                title: "foo",
                body: "bar",
                userId: 1
            }),
            headers: {
                "Content-type": "application/json; charset=UTF-8"
            }
        });

        msg.value = "";

    });
</script>
<h2>Registered Alarms</h2>
<ul id="registered-list"></ul>
<h2>Alarm Classes</h2>
<ul id="class-list"></ul>
<script>
    let evtSource = new EventSource('proxy/sse'),
    registeredList = document.getElementById('registered-list'),
    classList = document.getElementById('class-list');

    console.log('attempting sse...')

    evtSource.addEventListener("registration", function(e) {
        console.log('registration type message')
        var newElement = document.createElement("li");

        newElement.textContent = e.data;
        registeredList.appendChild(newElement);
    });

    evtSource.addEventListener("class", function(e) {
        console.log('class type message')
        var newElement = document.createElement("li");

        newElement.textContent = e.data;
        classList.appendChild(newElement);
    });

    evtSource.onerror = function(e) {
        console.log('error')
        console.log(e)
    }
</script>
</body>
</html>